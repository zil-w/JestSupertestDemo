(this["webpackJsonppart-5-bloglist-frontend"]=this["webpackJsonppart-5-bloglist-frontend"]||[]).push([[0],{39:function(e,t,n){e.exports=n(69)},69:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(17),u=n.n(c),o=n(1),l=n.n(o),i=n(2),s=n(7),m=n(38),d=function(e){var t=e.name,n=e.action;return a.a.createElement("button",{onClick:n},t)},f=n(9),p=function(e){var t=e.blog,n=e.blogUpdate,c=e.blogDelete,u=e.loggedInName,o=Object(r.useState)(!1),p=Object(s.a)(o,2),b=p[0],g=p[1],E={display:b?"":"none"},v=function(){var e=Object(i.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(m.a)({},t,{likes:t.likes+1}),e.next=3,n(r);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Would you like to delete this blog?")){e.next=4;break}return e.next=4,c(t.id);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"blog",style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},a.a.createElement(f.b,{to:"/blogs/".concat(t.id)}," ",t.title," ")," ",t.author," ",a.a.createElement(d,{name:b?"Hide":"Show",action:function(){g(!b)}}),a.a.createElement("div",{className:"conditionally_displayed",style:E},"URL: ",t.url,a.a.createElement("br",null),"likes: ",t.likes,a.a.createElement(d,{name:"like",action:v}),t.user&&t.user.name===u&&a.a.createElement(d,{name:"delete",action:h}),t.user&&a.a.createElement(a.a.Fragment,null,a.a.createElement("br",null),"Poster: ",t.user.name)))},b=n(12),g=n.n(b),E={getAll:function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),authenticateUser:function(){var e=Object(i.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/",{username:t,password:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),submitBlog:function(){var e=Object(i.a)(l.a.mark((function e(t,n,r,a){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/blogs",{title:t,url:n,author:r},{headers:{Authorization:"bearer ".concat(a)}});case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),updateBlog:function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete t.user,e.next=3,g.a.put("/api/blogs"+"/".concat(t.id),t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.delete("/api/blogs"+"/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=function(e){return{type:"SET_SUCCESS",data:e}},h=function(e){return{type:"SET_FAILURE",data:e}},w=function(){return{type:"RESET"}},O=function(e){return{type:"SET_BLOGS",data:e}},y=function(e){return{type:"ADD_BLOG",data:e}},j=function(e){return{type:"LIKE_BLOG",data:e}},S=function(e){return{type:"DELETE_BLOG",data:e}},k=function(e){return function(){var t=Object(i.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.deleteBlog(e.id);case 2:r=t.sent,n({type:"DELETE_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},x=function(e){return function(){var t=Object(i.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.updateBlog(e);case 2:r=t.sent,n({type:"LIKE_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},B=function(e){return{type:"SET_USER",data:e}},R=function(){return{type:"RESET_USER"}},T=function(e){return{type:"SET_USERS",data:e}},_={notificationReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:"",isError:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SUCCESS":return{message:t.data,isError:!1};case"SET_FAILURE":return{message:t.data,isError:!0};case"RESET":return{message:"",isError:!1};default:return e}},blogReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BLOGS":return t.data;case"ADD_BLOG":return e.concat(t.data);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?t.data:e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data.name;case"RESET_USER":return"";default:return e}},usersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.data;case"RESET_USER":return[];default:return e}}},L=n(4),U=function(e){var t=e.blogUpdate,n=e.blogDelete,c=function(e,t){return e.likes>t.likes?-1:t.likes>e.likes?1:0},u=Object(L.c)((function(e){return e.blogs.sort(c)})),o=Object(L.b)();Object(r.useEffect)((function(){(function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:t=e.sent,o(O(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[o]);var s=window.localStorage.getItem("name"),m=u.map((function(e){return a.a.createElement(p,{key:e.id,blog:e,blogUpdate:t,blogDelete:n,loggedInName:s})}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Blogs:"),a.a.createElement("br",null),m)},I=function(e){var t=e.loginHandler,n=e.username,r=e.setUsername,c=e.password,u=e.setPassword;return a.a.createElement("form",{onSubmit:t},"Username: ",a.a.createElement("input",{type:"text",id:"username",value:n,onChange:function(e){return r(e.target.value)}}),a.a.createElement("br",null),"Password: ",a.a.createElement("input",{type:"text",id:"password",value:c,onChange:function(e){return u(e.target.value)}}),a.a.createElement("button",{type:"submit",id:"login-button"},"Login"))},A=function(e){var t=e.formSubHandler,n=Object(r.useState)(""),c=Object(s.a)(n,2),u=c[0],o=c[1],m=Object(r.useState)(""),d=Object(s.a)(m,2),f=d[0],p=d[1],b=Object(r.useState)(""),g=Object(s.a)(b,2),E=g[0],v=g[1],h=function(){var e=Object(i.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t(u,f,E);case 3:e.sent&&(o(""),p(""),v(""));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:h},a.a.createElement("label",{htmlFor:"Title"},"Title:"),a.a.createElement("input",{type:"text",id:"Title",value:u,onChange:function(e){return o(e.target.value)}}),a.a.createElement("br",null),a.a.createElement("label",{htmlFor:"Blog_URL"},"Blog URL:"),a.a.createElement("input",{type:"text",id:"Blog_URL",value:f,onChange:function(e){return p(e.target.value)}}),a.a.createElement("br",null),a.a.createElement("label",{htmlFor:"Blog_Author"},"BlogAuthor:"),a.a.createElement("input",{type:"text",id:"Blog_Author",value:E,onChange:function(e){return v(e.target.value)}}),a.a.createElement("br",null),a.a.createElement("button",{type:"submit",id:"Submission_Button"},"Add blog"))},D=function(){var e=Object(L.c)((function(e){return e.notification}));return""===e.message?a.a.createElement(a.a.Fragment,null):a.a.createElement("p",{id:"system-status",style:e.isError?{color:"red",width:500,borderWidth:"thin",border:"solid red"}:{color:"green",width:500,borderWidth:"thin",border:"solid green"}},e.message)},F=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(s.a)(n,2),u=c[0],o=c[1],l={display:u?"none":""},i={display:u?"":"none"},m=function(){o(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:l},a.a.createElement(d,{name:e.showButtonName,action:m})),a.a.createElement("div",{style:i},a.a.createElement(d,{name:e.hideButtonName,action:m}),e.children))}));F.displayName="Toggle";var C=F,G=function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/api/users");case 2:return t=e.sent,console.log("in users service",t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(L.c)((function(e){return e.users})),t=Object(L.b)();return Object(r.useEffect)((function(){(function(){var e=Object(i.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:n=e.sent,t(T(n));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]),e.length>0?a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,"Users information:"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("b",null,"user")),a.a.createElement("td",null,a.a.createElement("b",null,"blog(s) created"))),e.map((function(e){return a.a.createElement("tr",{key:e.id},a.a.createElement("td",null,a.a.createElement(f.b,{to:{pathname:"/users/".concat(e.id),state:{userInfo:e}}},e.name)),a.a.createElement("td",null,e.blogs.length))}))))):a.a.createElement("h1",null,"Waiting ")},N=n(3),W=function(){var e=Object(N.g)().id,t=Object(L.c)((function(t){return t.users.filter((function(t){return t.id===e}))}));return t.length>0?a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,"This is user: ".concat(t[0].name)),a.a.createElement("br",null),"His submitted blogs are ",a.a.createElement("br",null),a.a.createElement("ul",null,t[0].blogs.map((function(e){return a.a.createElement("li",null,e.title)})))):a.a.createElement("h1",null,"Try backstep in your browser...")},P=function(){var e=Object(N.g)().id,t=Object(L.c)((function(t){return t.blogs.filter((function(t){return t.id===e}))})),n=Object(L.b)();return t.length>0?a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,"Blog submission:"),a.a.createElement("br",null),"Title: ",t[0].title,a.a.createElement("br",null),"Author: ",t[0].author,a.a.createElement("br",null),"URL: ",t[0].url,a.a.createElement("br",null),"likes: ",t[0].likes,a.a.createElement("br",null),a.a.createElement(d,{name:"like",action:function(){return function(e){e.likes+=1,n(x(e))}(t[0])}}),t[0].user&&t[0].user.name===localStorage.getItem("name")&&a.a.createElement(d,{name:"delete",action:function(){return function(e){n(k(e))}(t[0])}})):a.a.createElement("h1",null,"Try backstep in your browser...")},K=function(e){var t=e.name,n=e.logoutHandler;return a.a.createElement("div",{style:{backgroundColor:"gray"}},a.a.createElement(f.b,{to:"/"},"blogs")," ",a.a.createElement(f.b,{to:"/users"},"users")," ","Logged in as ",t," ",a.a.createElement(d,{name:"logout",action:n}))},J=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(""),o=Object(s.a)(u,2),m=o[0],f=o[1],p=Object(r.useState)([]),b=Object(s.a)(p,2),g=b[0],O=b[1],k=Object(r.useState)(!1),x=Object(s.a)(k,2),T=x[0],_=x[1],F=Object(L.b)(),G=Object(L.c)((function(e){return e.notification})),J=Object(L.c)((function(e){return e.user})),V=Object(r.useRef)(),z=Object(N.f)();Object(r.useEffect)((function(){(function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:t=e.sent,O(t),null!==window.localStorage.getItem("token")&&null!==window.localStorage.getItem("name")&&(_(!0),F(B({name:window.localStorage.getItem("name")})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var M=function(e){F(v(e))},q=function(e){F(h(e))},Q=function(e){setTimeout((function(){return F(w())}),e)},X=function(){var e=Object(i.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,E.authenticateUser(n,m);case 4:(r=e.sent).token?(window.localStorage.setItem("token",r.token),window.localStorage.setItem("name",r.name),_(!0),F(B(r)),c(""),f(""),M("Successfully logged in.")):q("Authentication failed."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),q("Something went wrong: ".concat(e.t0.response.data.error));case 11:Q(3e3);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("name"),_(!1),F(R()),z.push("/")},Z=function(){var e=Object(i.a)(l.a.mark((function e(t,n,r){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,e.prev=1,e.next=4,E.submitBlog(t,n,r,window.localStorage.getItem("token"));case 4:c=e.sent,F(y(c)),M("Blog submission successful."),V.current.toggleVisibility(),a=!0,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("blog submission failed",e.t0.response.data.error),q(e.t0.response.data.error);case 15:return Q(3e3),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n,r){return e.apply(this,arguments)}}(),$=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.updateBlog(t);case 3:n=e.sent,F(j(n)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),q(e.t0.response.data.error),Q(3e3);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.deleteBlog(t);case 3:n=e.sent,F(S(n)),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("failed to delete blog:",e.t0),q(e.t0.response.data.error),Q(3e3);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return""!==J?a.a.createElement(a.a.Fragment,null,G.message&&a.a.createElement(D,null),a.a.createElement(K,{name:J,logoutHandler:Y}),a.a.createElement(N.c,null,a.a.createElement(N.a,{path:"/users/:id"},a.a.createElement(W,null)),a.a.createElement(N.a,{path:"/users"},a.a.createElement(H,null)),a.a.createElement(N.a,{path:"/blogs/:id"},a.a.createElement(P,null)),a.a.createElement(N.a,{path:"/"},a.a.createElement("div",null,T&&a.a.createElement("div",null,a.a.createElement("h2",null,"Hello ",J,"!"),a.a.createElement(d,{name:"log out",action:Y}),a.a.createElement(C,{ref:V,showButtonName:"Add Blog",hideButtonName:"Cancel"},a.a.createElement(A,{formSubHandler:Z})),a.a.createElement(U,{blogs:g,blogUpdate:$,blogDelete:ee})))))):a.a.createElement(N.c,null,a.a.createElement(N.a,{path:"/"},a.a.createElement(I,{loginHandler:X,username:n,setUsername:c,password:m,setPassword:f})))},V=n(13),z=n(36),M=n(37),q=Object(V.combineReducers)({notification:_.notificationReducer,blogs:_.blogReducer,user:_.userReducer,users:_.usersReducer}),Q=Object(V.createStore)(q,Object(z.composeWithDevTools)(Object(V.applyMiddleware)(M.a)));u.a.render(a.a.createElement(f.a,null,a.a.createElement(L.a,{store:Q},a.a.createElement(J,null))),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.330e2c80.chunk.js.map